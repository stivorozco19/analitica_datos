<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gu√≠a Pr√°ctica - Manipulaci√≥n de Datos: Sheets vs Python</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.3rem;
            opacity: 0.9;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid linear-gradient(90deg, #667eea, #764ba2);
            position: relative;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .comparison-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .method-card {
            padding: 25px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .method-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
        }

        .sheets-method {
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
            border: 2px solid #ff7675;
        }

        .sheets-method::before {
            background: linear-gradient(90deg, #ff7675, #fd79a8);
        }

        .python-method {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0984e3;
        }

        .python-method::before {
            background: linear-gradient(90deg, #74b9ff, #0984e3);
        }

        .method-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .method-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .sheets-icon {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
        }

        .python-icon {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
        }

        .method-title {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .code-block {
            background: #1a202c;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.5;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .code-comment {
            color: #68d391;
            font-style: italic;
        }

        .code-keyword {
            color: #f093fb;
            font-weight: bold;
        }

        .code-string {
            color: #ffd93d;
        }

        .code-function {
            color: #4fd1c7;
        }

        .formula-block {
            background: #f8f9fa;
            border-left: 4px solid #ff7675;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            border-radius: 5px;
        }

        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }

        .tip-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            border-left: 5px solid #fdcb6e;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .tip-box h4 {
            color: #d63031;
            margin-bottom: 10px;
        }

        .warning-box {
            background: linear-gradient(135deg, #fab1a0 0%, #ff7675 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .success-box {
            background: linear-gradient(135deg, #55efc4 0%, #00b894 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .process-flow {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
        }

        .process-step {
            text-align: center;
            flex: 1;
            position: relative;
        }

        .process-step::after {
            content: '‚Üí';
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 2rem;
            color: #667eea;
        }

        .process-step:last-child::after {
            display: none;
        }

        .process-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 2rem;
            color: white;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .highlight {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .tab-container {
            margin: 30px 0;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 12px 24px;
            border: none;
            background: #e9ecef;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 0 15px 15px 15px;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .comparison-container {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .process-flow {
                flex-direction: column;
                gap: 30px;
            }
            
            .process-step::after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üîÑ Gu√≠a Pr√°ctica: Manipulaci√≥n de Datos</h1>
            <p>Comparaci√≥n paso a paso: Google Sheets vs Python con Pandas</p>
        </div>

        <!-- Flujo del Proceso -->
        <div class="section">
            <h2 class="section-title">üìä Flujo de Trabajo de Limpieza de Datos</h2>
            <div class="process-flow">
                <div class="process-step">
                    <div class="process-icon">üì•</div>
                    <h3>Cargar</h3>
                    <p>Importar datos</p>
                </div>
                <div class="process-step">
                    <div class="process-icon">üîç</div>
                    <h3>Explorar</h3>
                    <p>Entender estructura</p>
                </div>
                <div class="process-step">
                    <div class="process-icon">üßπ</div>
                    <h3>Limpiar</h3>
                    <p>Corregir problemas</p>
                </div>
                <div class="process-step">
                    <div class="process-icon">üîÑ</div>
                    <h3>Transformar</h3>
                    <p>Crear nuevas variables</p>
                </div>
                <div class="process-step">
                    <div class="process-icon">üìä</div>
                    <h3>Analizar</h3>
                    <p>Extraer insights</p>
                </div>
            </div>
        </div>

        <!-- Paso 1: Carga de Datos -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">1</span>Carga y Primera Vista del Dataset</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <ol>
                        <li>Archivo ‚Üí Importar ‚Üí Subir CSV</li>
                        <li>Ver primeras filas visualmente</li>
                        <li>Contar filas con f√≥rmula:</li>
                    </ol>
                    <div class="formula-block">
                        =COUNTA(A:A) - 1  // Resta 1 para excluir encabezado
                    </div>
                    <p style="margin-top: 15px;">‚è±Ô∏è <strong>Tiempo:</strong> 2-3 minutos manual</p>
                    <p>‚ö†Ô∏è <strong>L√≠mite:</strong> M√°ximo ~1 mill√≥n de celdas</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-keyword">import</span> pandas <span class="code-keyword">as</span> pd
<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np

<span class="code-comment"># Cargar datos</span>
df = pd.<span class="code-function">read_csv</span>(<span class="code-string">'emprendimientos_20250824.csv'</span>)

<span class="code-comment"># Ver primeras 5 filas</span>
df.<span class="code-function">head</span>()

<span class="code-comment"># Dimensiones del dataset</span>
<span class="code-function">print</span>(<span class="code-string">f"Filas: {df.shape[0]}, Columnas: {df.shape[1]}"</span>)
                    </div>
                    <p>‚ö° <strong>Tiempo:</strong> < 1 segundo</p>
                    <p>‚úÖ <strong>L√≠mite:</strong> Solo limitado por RAM</p>
                </div>
            </div>
        </div>

        <!-- Paso 2: Identificaci√≥n de Problemas -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">2</span>Identificaci√≥n de Problemas de Calidad</h2>
            
            <div class="tip-box">
                <h4>üí° Tip Importante</h4>
                <p>El 80% del tiempo en an√°lisis de datos se gasta en limpieza. Identificar problemas temprano ahorra horas de trabajo.</p>
            </div>

            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <ul>
                        <li><strong>Celdas vac√≠as:</strong> B√∫squeda visual (muy lento)</li>
                        <li><strong>Duplicados:</strong> Formato ‚Üí Formato condicional ‚Üí Resaltar duplicados</li>
                        <li><strong>Valores raros:</strong> Buscar "N/A", "null", "#REF!" manualmente</li>
                        <li><strong>Tipos incorrectos:</strong> Ver si hay n√∫meros como texto (alineaci√≥n izquierda)</li>
                    </ul>
                    <div class="formula-block">
                        =COUNTBLANK(B:B)  // Contar celdas vac√≠as en columna B
                        =COUNTIF(A:A, "N/A")  // Contar valores "N/A"
                    </div>
                    <p style="margin-top: 15px;">üò∞ <strong>Problema:</strong> Proceso manual tedioso para datasets grandes</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Informaci√≥n general del dataset</span>
df.<span class="code-function">info</span>()

<span class="code-comment"># Detectar valores nulos</span>
valores_nulos = df.<span class="code-function">isnull</span>().<span class="code-function">sum</span>()
<span class="code-function">print</span>(<span class="code-string">"Valores nulos por columna:"</span>)
<span class="code-function">print</span>(valores_nulos[valores_nulos > 0])

<span class="code-comment"># Porcentaje de valores nulos</span>
porcentaje_nulos = (df.<span class="code-function">isnull</span>().<span class="code-function">sum</span>() / <span class="code-function">len</span>(df)) * 100
<span class="code-function">print</span>(<span class="code-string">f"\nPorcentaje de nulos:\n{porcentaje_nulos}"</span>)

<span class="code-comment"># Detectar duplicados</span>
duplicados = df.<span class="code-function">duplicated</span>().<span class="code-function">sum</span>()
<span class="code-function">print</span>(<span class="code-string">f"\nFilas duplicadas: {duplicados}"</span>)

<span class="code-comment"># Ver los duplicados</span>
<span class="code-keyword">if</span> duplicados > 0:
    <span class="code-function">print</span>(<span class="code-string">"\nPrimeros duplicados encontrados:"</span>)
    <span class="code-function">print</span>(df[df.<span class="code-function">duplicated</span>(keep=<span class="code-keyword">False</span>)].<span class="code-function">head</span>())
                    </div>
                    <p>‚úÖ <strong>Ventaja:</strong> Detecci√≥n autom√°tica y completa en segundos</p>
                </div>
            </div>
        </div>

        <!-- Paso 3: Estad√≠sticas Descriptivas -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">3</span>Estad√≠sticas Descriptivas</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <p><strong>F√≥rmulas individuales para cada estad√≠stica:</strong></p>
                    <div class="formula-block">
                        =AVERAGE(B:B)    // Promedio
                        =SUM(B:B)        // Suma total
                        =MAX(B:B)        // Valor m√°ximo
                        =MIN(B:B)        // Valor m√≠nimo
                        =MEDIAN(B:B)     // Mediana
                        =STDEV(B:B)      // Desviaci√≥n est√°ndar
                        =COUNTUNIQUE(A:A) // Valores √∫nicos
                    </div>
                    <p style="margin-top: 15px;">üìù <strong>Nota:</strong> Necesitas crear cada f√≥rmula manualmente</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Todas las estad√≠sticas de una vez</span>
df.<span class="code-function">describe</span>()

<span class="code-comment"># Estad√≠sticas espec√≠ficas</span>
<span class="code-function">print</span>(<span class="code-string">f"Promedio de ventas: {df['ventas'].mean():.2f}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Mediana de ventas: {df['ventas'].median():.2f}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Desv. est√°ndar: {df['ventas'].std():.2f}"</span>)

<span class="code-comment"># Para columnas categ√≥ricas</span>
<span class="code-function">print</span>(<span class="code-string">f"\nCategor√≠as √∫nicas: {df['categoria'].nunique()}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Moda: {df['categoria'].mode()[0]}"</span>)

<span class="code-comment"># Resumen personalizado</span>
resumen = df.<span class="code-function">agg</span>({
    <span class="code-string">'ventas'</span>: [<span class="code-string">'mean'</span>, <span class="code-string">'median'</span>, <span class="code-string">'std'</span>],
    <span class="code-string">'precio'</span>: [<span class="code-string">'min'</span>, <span class="code-string">'max'</span>],
    <span class="code-string">'categoria'</span>: <span class="code-string">'nunique'</span>
})
                    </div>
                    <p>‚ö° <strong>Un comando = Todas las estad√≠sticas</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 4: Limpieza de Valores Faltantes -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">4</span>Manejo de Valores Faltantes</h2>
            
            <div class="warning-box">
                <h4>‚ö†Ô∏è Decisi√≥n Cr√≠tica</h4>
                <p>La estrategia para manejar valores faltantes puede afectar significativamente tus an√°lisis. Piensa bien antes de eliminar o rellenar.</p>
            </div>

            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <ol>
                        <li><strong>Buscar y reemplazar:</strong> Ctrl+H</li>
                        <li><strong>Filtrar blancos:</strong> Datos ‚Üí Crear un filtro</li>
                        <li><strong>Rellenar manualmente</strong> con promedio o cero</li>
                    </ol>
                    <div class="formula-block">
                        =IF(ISBLANK(B2), AVERAGE(B:B), B2)
                        // Si est√° vac√≠o, usar promedio
                    </div>
                    <p style="margin-top: 15px;">üê¢ <strong>Problema:</strong> Muy lento para miles de celdas</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># ESTRATEGIA 1: Eliminar filas con nulos</span>
df_sin_nulos = df.<span class="code-function">dropna</span>()

<span class="code-comment"># ESTRATEGIA 2: Eliminar solo si columna espec√≠fica es nula</span>
df_sin_nulos = df.<span class="code-function">dropna</span>(subset=[<span class="code-string">'columna_critica'</span>])

<span class="code-comment"># ESTRATEGIA 3: Rellenar con valor espec√≠fico</span>
df[<span class="code-string">'columna'</span>] = df[<span class="code-string">'columna'</span>].<span class="code-function">fillna</span>(0)

<span class="code-comment"># ESTRATEGIA 4: Rellenar con estad√≠stica</span>
df[<span class="code-string">'precio'</span>] = df[<span class="code-string">'precio'</span>].<span class="code-function">fillna</span>(df[<span class="code-string">'precio'</span>].<span class="code-function">mean</span>())
df[<span class="code-string">'categoria'</span>] = df[<span class="code-string">'categoria'</span>].<span class="code-function">fillna</span>(df[<span class="code-string">'categoria'</span>].<span class="code-function">mode</span>()[0])

<span class="code-comment"># ESTRATEGIA 5: Forward/Backward fill (para series temporales)</span>
df[<span class="code-string">'fecha'</span>] = df[<span class="code-string">'fecha'</span>].<span class="code-function">fillna</span>(method=<span class="code-string">'ffill'</span>)
                    </div>
                    <p>‚úÖ <strong>M√∫ltiples estrategias disponibles instant√°neamente</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 5: Eliminaci√≥n de Duplicados -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">5</span>Eliminaci√≥n de Duplicados</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <ol>
                        <li>Seleccionar rango de datos</li>
                        <li>Datos ‚Üí Limpiar datos ‚Üí Quitar duplicados</li>
                        <li>Elegir columnas para considerar</li>
                        <li>Confirmar eliminaci√≥n</li>
                    </ol>
                    <p style="margin-top: 15px;">‚ö†Ô∏è <strong>Limitaci√≥n:</strong> No hay opci√≥n de preview antes de eliminar</p>
                    <p>üêå <strong>Velocidad:</strong> Lento con m√°s de 10,000 filas</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Ver cu√°ntos duplicados hay antes</span>
<span class="code-function">print</span>(<span class="code-string">f"Duplicados antes: {df.duplicated().sum()}"</span>)

<span class="code-comment"># Ver los duplicados</span>
duplicados = df[df.<span class="code-function">duplicated</span>(keep=<span class="code-keyword">False</span>)]
<span class="code-function">print</span>(duplicados.<span class="code-function">head</span>())

<span class="code-comment"># Eliminar duplicados completos</span>
df_limpio = df.<span class="code-function">drop_duplicates</span>()

<span class="code-comment"># Eliminar bas√°ndose en columnas espec√≠ficas</span>
df_limpio = df.<span class="code-function">drop_duplicates</span>(subset=[<span class="code-string">'id_cliente'</span>, <span class="code-string">'fecha'</span>])

<span class="code-comment"># Mantener el primer o √∫ltimo registro</span>
df_limpio = df.<span class="code-function">drop_duplicates</span>(keep=<span class="code-string">'first'</span>)  <span class="code-comment"># o 'last'</span>

<span class="code-function">print</span>(<span class="code-string">f"Duplicados despu√©s: {df_limpio.duplicated().sum()}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Filas eliminadas: {len(df) - len(df_limpio)}"</span>)
                    </div>
                    <p>‚úÖ <strong>Preview antes de eliminar + Control total</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 6: Limpieza de Strings -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">6</span>Limpieza de Texto y Formatos</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <p><strong>F√≥rmulas para limpiar texto:</strong></p>
                    <div class="formula-block">
                        =TRIM(A2)           // Quitar espacios extras
                        =UPPER(A2)          // Convertir a may√∫sculas
                        =LOWER(A2)          // Convertir a min√∫sculas
                        =PROPER(A2)         // Primera letra may√∫scula
                        =SUBSTITUTE(A2,"$","")  // Quitar s√≠mbolo $
                        =SUBSTITUTE(SUBSTITUTE(A2,"$",""),",","")  // Quitar $ y comas
                    </div>
                    <p style="margin-top: 15px;">üìù <strong>Proceso:</strong> Crear columna auxiliar ‚Üí Aplicar f√≥rmula ‚Üí Copiar valores</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Limpieza de espacios</span>
df[<span class="code-string">'producto'</span>] = df[<span class="code-string">'producto'</span>].str.<span class="code-function">strip</span>()

<span class="code-comment"># Conversi√≥n de caso</span>
df[<span class="code-string">'producto'</span>] = df[<span class="code-string">'producto'</span>].str.<span class="code-function">upper</span>()
df[<span class="code-string">'categoria'</span>] = df[<span class="code-string">'categoria'</span>].str.<span class="code-function">title</span>()

<span class="code-comment"># Limpieza de caracteres especiales en precios</span>
df[<span class="code-string">'precio_str'</span>] = df[<span class="code-string">'precio_str'</span>].str.<span class="code-function">replace</span>(<span class="code-string">'[$,]'</span>, <span class="code-string">''</span>, regex=<span class="code-keyword">True</span>)
df[<span class="code-string">'precio'</span>] = pd.<span class="code-function">to_numeric</span>(df[<span class="code-string">'precio_str'</span>])

<span class="code-comment"># Limpieza masiva de m√∫ltiples columnas</span>
columnas_texto = [<span class="code-string">'producto'</span>, <span class="code-string">'descripcion'</span>, <span class="code-string">'categoria'</span>]
<span class="code-keyword">for</span> col <span class="code-keyword">in</span> columnas_texto:
    df[col] = df[col].str.<span class="code-function">strip</span>().str.<span class="code-function">upper</span>()
    
<span class="code-comment"># Normalizaci√≥n de texto (quitar acentos)</span>
<span class="code-keyword">import</span> unicodedata
df[<span class="code-string">'producto'</span>] = df[<span class="code-string">'producto'</span>].<span class="code-function">apply</span>(
    <span class="code-keyword">lambda</span> x: unicodedata.<span class="code-function">normalize</span>(<span class="code-string">'NFKD'</span>, x).<span class="code-function">encode</span>(<span class="code-string">'ascii'</span>, <span class="code-string">'ignore'</span>).<span class="code-function">decode</span>()
)
                    </div>
                    <p>‚ö° <strong>Aplicaci√≥n instant√°nea a miles de filas</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 7: Conversi√≥n de Tipos -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">7</span>Conversi√≥n de Tipos de Datos</h2>
            
            <div class="tip-box">
                <h4>üí° ¬øPor qu√© es importante?</h4>
                <p>Los tipos de datos incorrectos impiden hacer c√°lculos, gr√°ficos y an√°lisis. Una fecha como texto no se puede ordenar cronol√≥gicamente.</p>
            </div>

            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <ol>
                        <li>Seleccionar columna</li>
                        <li>Formato ‚Üí N√∫mero ‚Üí Elegir tipo</li>
                        <li>Opciones: N√∫mero, Fecha, Moneda, Porcentaje</li>
                    </ol>
                    <p style="margin-top: 15px;">‚ö†Ô∏è <strong>Problema com√∫n:</strong> Fechas en formato texto no se convierten bien</p>
                    <div class="formula-block">
                        =DATEVALUE(A2)  // Convertir texto a fecha
                        =VALUE(B2)      // Convertir texto a n√∫mero
                    </div>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Ver tipos actuales</span>
<span class="code-function">print</span>(df.dtypes)

<span class="code-comment"># Convertir a fecha (m√∫ltiples formatos)</span>
df[<span class="code-string">'fecha'</span>] = pd.<span class="code-function">to_datetime</span>(df[<span class="code-string">'fecha'</span>], format=<span class="code-string">'%d/%m/%Y'</span>)
<span class="code-comment"># O dejar que pandas detecte el formato</span>
df[<span class="code-string">'fecha'</span>] = pd.<span class="code-function">to_datetime</span>(df[<span class="code-string">'fecha'</span>], infer_datetime_format=<span class="code-keyword">True</span>)

<span class="code-comment"># Convertir a n√∫mero (maneja errores)</span>
df[<span class="code-string">'precio'</span>] = pd.<span class="code-function">to_numeric</span>(df[<span class="code-string">'precio'</span>], errors=<span class="code-string">'coerce'</span>)

<span class="code-comment"># Convertir a categor√≠a (ahorra memoria)</span>
df[<span class="code-string">'categoria'</span>] = df[<span class="code-string">'categoria'</span>].<span class="code-function">astype</span>(<span class="code-string">'category'</span>)

<span class="code-comment"># Convertir a entero</span>
df[<span class="code-string">'cantidad'</span>] = df[<span class="code-string">'cantidad'</span>].<span class="code-function">astype</span>(<span class="code-string">'int'</span>)

<span class="code-comment"># Conversi√≥n masiva con diccionario</span>
conversiones = {
    <span class="code-string">'precio'</span>: <span class="code-string">'float'</span>,
    <span class="code-string">'cantidad'</span>: <span class="code-string">'int'</span>,
    <span class="code-string">'categoria'</span>: <span class="code-string">'category'</span>
}
df = df.<span class="code-function">astype</span>(conversiones)
                    </div>
                    <p>‚úÖ <strong>Manejo autom√°tico de errores y formatos</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 8: Creaci√≥n de Nuevas Columnas -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">8</span>Creaci√≥n de Nuevas Variables</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <p><strong>Crear columnas calculadas:</strong></p>
                    <div class="formula-block">
                        =B2*C2              // Total = precio √ó cantidad
                        =IF(B2>100,"Alto","Bajo")  // Categorizaci√≥n
                        =MONTH(A2)          // Extraer mes de fecha
                        =YEAR(A2)           // Extraer a√±o
                        =TEXT(A2,"dddd")    // D√≠a de la semana
                        =IFS(B2>1000000,"VIP",B2>500000,"Premium",TRUE,"Regular")
                    </div>
                    <p style="margin-top: 15px;">üìù <strong>Arrastrar f√≥rmula hacia abajo para aplicar a todas las filas</strong></p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Columnas calculadas simples</span>
df[<span class="code-string">'total'</span>] = df[<span class="code-string">'precio'</span>] * df[<span class="code-string">'cantidad'</span>]
df[<span class="code-string">'ganancia'</span>] = df[<span class="code-string">'ingresos'</span>] - df[<span class="code-string">'costos'</span>]
df[<span class="code-string">'margen_porcentaje'</span>] = (df[<span class="code-string">'ganancia'</span>] / df[<span class="code-string">'ingresos'</span>]) * 100

<span class="code-comment"># Categorizaci√≥n simple</span>
df[<span class="code-string">'categoria_precio'</span>] = df[<span class="code-string">'precio'</span>].<span class="code-function">apply</span>(
    <span class="code-keyword">lambda</span> x: <span class="code-string">'Alto'</span> <span class="code-keyword">if</span> x > 100 <span class="code-keyword">else</span> <span class="code-string">'Bajo'</span>
)

<span class="code-comment"># Categorizaci√≥n compleja con funci√≥n</span>
<span class="code-keyword">def</span> <span class="code-function">categorizar_cliente</span>(row):
    <span class="code-keyword">if</span> row[<span class="code-string">'total'</span>] > 1000000:
        <span class="code-keyword">return</span> <span class="code-string">'VIP'</span>
    <span class="code-keyword">elif</span> row[<span class="code-string">'total'</span>] > 500000:
        <span class="code-keyword">return</span> <span class="code-string">'Premium'</span>
    <span class="code-keyword">else</span>:
        <span class="code-keyword">return</span> <span class="code-string">'Regular'</span>

df[<span class="code-string">'tipo_cliente'</span>] = df.<span class="code-function">apply</span>(categorizar_cliente, axis=1)

<span class="code-comment"># Extraer componentes de fecha</span>
df[<span class="code-string">'a√±o'</span>] = df[<span class="code-string">'fecha'</span>].dt.year
df[<span class="code-string">'mes'</span>] = df[<span class="code-string">'fecha'</span>].dt.month
df[<span class="code-string">'dia_semana'</span>] = df[<span class="code-string">'fecha'</span>].dt.<span class="code-function">day_name</span>()
df[<span class="code-string">'trimestre'</span>] = df[<span class="code-string">'fecha'</span>].dt.quarter
df[<span class="code-string">'es_fin_semana'</span>] = df[<span class="code-string">'fecha'</span>].dt.dayofweek >= 5
                    </div>
                    <p>‚ö° <strong>Creaci√≥n instant√°nea de m√∫ltiples columnas</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 9: Agrupaci√≥n y Agregaci√≥n -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">9</span>Agrupaci√≥n y An√°lisis por Categor√≠as</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <p><strong>Opci√≥n 1: Tabla Din√°mica</strong></p>
                    <ol>
                        <li>Insertar ‚Üí Tabla din√°mica</li>
                        <li>Arrastrar campos a filas/columnas/valores</li>
                        <li>Elegir funci√≥n (suma, promedio, contar)</li>
                    </ol>
                    <p><strong>Opci√≥n 2: F√≥rmulas</strong></p>
                    <div class="formula-block">
                        =SUMIF(A:A,"Tecnolog√≠a",B:B)     // Suma por categor√≠a
                        =AVERAGEIF(A:A,"Tecnolog√≠a",B:B) // Promedio por categor√≠a
                        =COUNTIF(A:A,"Tecnolog√≠a")       // Contar por categor√≠a
                    </div>
                    <p style="margin-top: 15px;">‚ö†Ô∏è <strong>Limitaci√≥n:</strong> Una f√≥rmula por cada categor√≠a</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Agrupaci√≥n simple</span>
ventas_por_categoria = df.<span class="code-function">groupby</span>(<span class="code-string">'categoria'</span>)[<span class="code-string">'ventas'</span>].<span class="code-function">sum</span>()

<span class="code-comment"># M√∫ltiples agregaciones</span>
resumen = df.<span class="code-function">groupby</span>(<span class="code-string">'categoria'</span>).<span class="code-function">agg</span>({
    <span class="code-string">'ventas'</span>: [<span class="code-string">'sum'</span>, <span class="code-string">'mean'</span>, <span class="code-string">'count'</span>],
    <span class="code-string">'precio'</span>: [<span class="code-string">'mean'</span>, <span class="code-string">'min'</span>, <span class="code-string">'max'</span>],
    <span class="code-string">'ganancia'</span>: <span class="code-string">'sum'</span>
})

<span class="code-comment"># Agrupar por m√∫ltiples columnas</span>
ventas_region_mes = df.<span class="code-function">groupby</span>([<span class="code-string">'region'</span>, <span class="code-string">'mes'</span>]).<span class="code-function">agg</span>({
    <span class="code-string">'ventas'</span>: <span class="code-string">'sum'</span>,
    <span class="code-string">'clientes'</span>: <span class="code-string">'nunique'</span>
})

<span class="code-comment"># Tabla pivote (como tabla din√°mica de Sheets)</span>
tabla_pivote = pd.<span class="code-function">pivot_table</span>(
    df,
    values=<span class="code-string">'ventas'</span>,
    index=<span class="code-string">'categoria'</span>,
    columns=<span class="code-string">'mes'</span>,
    aggfunc=<span class="code-string">'sum'</span>,
    fill_value=0
)

<span class="code-comment"># Top 10 productos</span>
top_productos = df.<span class="code-function">groupby</span>(<span class="code-string">'producto'</span>)[<span class="code-string">'ventas'</span>].<span class="code-function">sum</span>().<span class="code-function">nlargest</span>(10)
                    </div>
                    <p>‚úÖ <strong>An√°lisis complejos en una l√≠nea de c√≥digo</strong></p>
                </div>
            </div>
        </div>

        <!-- Paso 10: Filtrado Avanzado -->
        <div class="section">
            <h2 class="section-title"><span class="step-number">10</span>Filtrado Avanzado de Datos</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Google Sheets</div>
                    </div>
                    <p><strong>Filtros b√°sicos:</strong></p>
                    <ol>
                        <li>Datos ‚Üí Crear un filtro</li>
                        <li>Click en el √≠cono de filtro de cada columna</li>
                        <li>Seleccionar valores o condiciones</li>
                    </ol>
                    <p><strong>Filtro con f√≥rmula:</strong></p>
                    <div class="formula-block">
                        =FILTER(A:C, (B:B>100)*(C:C="Tecnolog√≠a"))
                        // Filtrar donde precio>100 Y categor√≠a=Tecnolog√≠a
                    </div>
                    <p style="margin-top: 15px;">üòì <strong>Limitaci√≥n:</strong> Combinar m√∫ltiples condiciones es complejo</p>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Python con Pandas</div>
                    </div>
                    <div class="code-block">
<span class="code-comment"># Filtro simple</span>
ventas_altas = df[df[<span class="code-string">'ventas'</span>] > 100000]

<span class="code-comment"># M√∫ltiples condiciones con & (AND)</span>
filtro_and = df[
    (df[<span class="code-string">'ventas'</span>] > 100000) & 
    (df[<span class="code-string">'categoria'</span>] == <span class="code-string">'Tecnolog√≠a'</span>) &
    (df[<span class="code-string">'region'</span>] == <span class="code-string">'Bogot√°'</span>)
]

<span class="code-comment"># M√∫ltiples condiciones con | (OR)</span>
filtro_or = df[
    (df[<span class="code-string">'categoria'</span>] == <span class="code-string">'Tecnolog√≠a'</span>) | 
    (df[<span class="code-string">'categoria'</span>] == <span class="code-string">'Electr√≥nica'</span>)
]

<span class="code-comment"># Filtrar por lista de valores</span>
categorias_interes = [<span class="code-string">'Tecnolog√≠a'</span>, <span class="code-string">'Moda'</span>, <span class="code-string">'Hogar'</span>]
filtro_lista = df[df[<span class="code-string">'categoria'</span>].<span class="code-function">isin</span>(categorias_interes)]

<span class="code-comment"># Filtrar por rango de fechas</span>
fecha_inicio = <span class="code-string">'2024-01-01'</span>
fecha_fin = <span class="code-string">'2024-03-31'</span>
primer_trimestre = df[
    (df[<span class="code-string">'fecha'</span>] >= fecha_inicio) & 
    (df[<span class="code-string">'fecha'</span>] <= fecha_fin)
]

<span class="code-comment"># Filtrar por string parcial</span>
productos_samsung = df[df[<span class="code-string">'producto'</span>].str.<span class="code-function">contains</span>(<span class="code-string">'Samsung'</span>, case=<span class="code-keyword">False</span>)]
                    </div>
                    <p>‚úÖ <strong>Filtros complejos f√°ciles de leer y mantener</strong></p>
                </div>
            </div>
        </div>

        <!-- Comparaci√≥n de Rendimiento -->
        <div class="section">
            <h2 class="section-title">‚ö° Comparaci√≥n de Rendimiento</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">1M</div>
                    <div class="stat-label">L√≠mite de celdas en Sheets</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">‚àû</div>
                    <div class="stat-label">L√≠mite en Python (RAM)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">100x</div>
                    <div class="stat-label">M√°s r√°pido en Python</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">80%</div>
                    <div class="stat-label">Tiempo ahorrado</div>
                </div>
            </div>

            <div class="tip-box" style="margin-top: 30px;">
                <h4>üìä Ejemplo Real de Tiempo</h4>
                <p><strong>Dataset de 50,000 filas:</strong></p>
                <ul>
                    <li>Google Sheets: 5-10 minutos para limpiar y procesar (manual)</li>
                    <li>Python: < 5 segundos (automatizado)</li>
                </ul>
            </div>
        </div>

        <!-- Script Completo de Ejemplo -->
        <div class="section">
            <h2 class="section-title">üöÄ Script Completo de Limpieza</h2>
            
            <div class="success-box">
                <h4>‚úÖ Copia y usa este script como plantilla</h4>
                <p>Este script contiene todo el proceso de limpieza que haremos en clase</p>
            </div>

            <div class="code-block">
<span class="code-keyword">import</span> pandas <span class="code-keyword">as</span> pd
<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 1. CARGAR DATOS</span>
<span class="code-comment"># ============================================</span>
df = pd.<span class="code-function">read_csv</span>(<span class="code-string">'emprendimientos_20250824.csv'</span>)
<span class="code-function">print</span>(<span class="code-string">f"Dataset original: {df.shape}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Columnas: {df.columns.tolist()}"</span>)

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 2. EXPLORACI√ìN INICIAL</span>
<span class="code-comment"># ============================================</span>
<span class="code-function">print</span>(<span class="code-string">"\n=== INFORMACI√ìN GENERAL ==="</span>)
df.<span class="code-function">info</span>()

<span class="code-function">print</span>(<span class="code-string">"\n=== ESTAD√çSTICAS DESCRIPTIVAS ==="</span>)
<span class="code-function">print</span>(df.<span class="code-function">describe</span>())

<span class="code-function">print</span>(<span class="code-string">"\n=== VALORES NULOS ==="</span>)
nulos = df.<span class="code-function">isnull</span>().<span class="code-function">sum</span>()
<span class="code-function">print</span>(nulos[nulos > 0])

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 3. LIMPIEZA DE DATOS</span>
<span class="code-comment"># ============================================</span>

<span class="code-comment"># Eliminar duplicados</span>
duplicados_antes = df.<span class="code-function">duplicated</span>().<span class="code-function">sum</span>()
df = df.<span class="code-function">drop_duplicates</span>()
<span class="code-function">print</span>(<span class="code-string">f"\nDuplicados eliminados: {duplicados_antes}"</span>)

<span class="code-comment"># Manejar valores nulos</span>
<span class="code-comment"># Opci√≥n 1: Eliminar filas con nulos en columnas cr√≠ticas</span>
columnas_criticas = [<span class="code-string">'id'</span>, <span class="code-string">'fecha'</span>]
df = df.<span class="code-function">dropna</span>(subset=columnas_criticas)

<span class="code-comment"># Opci√≥n 2: Rellenar nulos en columnas num√©ricas con mediana</span>
columnas_numericas = df.<span class="code-function">select_dtypes</span>(include=[<span class="code-string">'float64'</span>, <span class="code-string">'int64'</span>]).columns
<span class="code-keyword">for</span> col <span class="code-keyword">in</span> columnas_numericas:
    <span class="code-keyword">if</span> df[col].<span class="code-function">isnull</span>().<span class="code-function">any</span>():
        df[col] = df[col].<span class="code-function">fillna</span>(df[col].<span class="code-function">median</span>())

<span class="code-comment"># Opci√≥n 3: Rellenar nulos en columnas categ√≥ricas con moda</span>
columnas_categoricas = df.<span class="code-function">select_dtypes</span>(include=[<span class="code-string">'object'</span>]).columns
<span class="code-keyword">for</span> col <span class="code-keyword">in</span> columnas_categoricas:
    <span class="code-keyword">if</span> df[col].<span class="code-function">isnull</span>().<span class="code-function">any</span>():
        df[col] = df[col].<span class="code-function">fillna</span>(df[col].<span class="code-function">mode</span>()[0])

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 4. LIMPIEZA DE TEXTO</span>
<span class="code-comment"># ============================================</span>

<span class="code-comment"># Limpiar columnas de texto</span>
<span class="code-keyword">for</span> col <span class="code-keyword">in</span> columnas_categoricas:
    df[col] = df[col].str.<span class="code-function">strip</span>()  <span class="code-comment"># Quitar espacios</span>
    df[col] = df[col].str.<span class="code-function">upper</span>()  <span class="code-comment"># May√∫sculas</span>

<span class="code-comment"># Limpiar columnas de precios (si existen)</span>
<span class="code-keyword">if</span> <span class="code-string">'precio'</span> <span class="code-keyword">in</span> df.columns:
    <span class="code-keyword">if</span> df[<span class="code-string">'precio'</span>].dtype == <span class="code-string">'object'</span>:
        df[<span class="code-string">'precio'</span>] = df[<span class="code-string">'precio'</span>].str.<span class="code-function">replace</span>(<span class="code-string">'[$,]'</span>, <span class="code-string">''</span>, regex=<span class="code-keyword">True</span>)
        df[<span class="code-string">'precio'</span>] = pd.<span class="code-function">to_numeric</span>(df[<span class="code-string">'precio'</span>], errors=<span class="code-string">'coerce'</span>)

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 5. CONVERSI√ìN DE TIPOS</span>
<span class="code-comment"># ============================================</span>

<span class="code-comment"># Convertir fechas</span>
columnas_fecha = [<span class="code-string">'fecha'</span>, <span class="code-string">'fecha_inicio'</span>, <span class="code-string">'fecha_fin'</span>]
<span class="code-keyword">for</span> col <span class="code-keyword">in</span> columnas_fecha:
    <span class="code-keyword">if</span> col <span class="code-keyword">in</span> df.columns:
        df[col] = pd.<span class="code-function">to_datetime</span>(df[col], errors=<span class="code-string">'coerce'</span>)

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 6. CREACI√ìN DE NUEVAS COLUMNAS</span>
<span class="code-comment"># ============================================</span>

<span class="code-comment"># Si hay columna de fecha, extraer componentes</span>
<span class="code-keyword">if</span> <span class="code-string">'fecha'</span> <span class="code-keyword">in</span> df.columns:
    df[<span class="code-string">'a√±o'</span>] = df[<span class="code-string">'fecha'</span>].dt.year
    df[<span class="code-string">'mes'</span>] = df[<span class="code-string">'fecha'</span>].dt.month
    df[<span class="code-string">'dia_semana'</span>] = df[<span class="code-string">'fecha'</span>].dt.<span class="code-function">day_name</span>()
    df[<span class="code-string">'trimestre'</span>] = df[<span class="code-string">'fecha'</span>].dt.quarter

<span class="code-comment"># Crear columnas calculadas (ejemplo)</span>
<span class="code-keyword">if</span> <span class="code-string">'precio'</span> <span class="code-keyword">in</span> df.columns <span class="code-keyword">and</span> <span class="code-string">'cantidad'</span> <span class="code-keyword">in</span> df.columns:
    df[<span class="code-string">'total'</span>] = df[<span class="code-string">'precio'</span>] * df[<span class="code-string">'cantidad'</span>]

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 7. DETECCI√ìN DE OUTLIERS</span>
<span class="code-comment"># ============================================</span>

<span class="code-keyword">for</span> col <span class="code-keyword">in</span> columnas_numericas:
    Q1 = df[col].<span class="code-function">quantile</span>(0.25)
    Q3 = df[col].<span class="code-function">quantile</span>(0.75)
    IQR = Q3 - Q1
    outliers = df[(df[col] < Q1 - 1.5 * IQR) | (df[col] > Q3 + 1.5 * IQR)]
    <span class="code-keyword">if</span> <span class="code-function">len</span>(outliers) > 0:
        <span class="code-function">print</span>(<span class="code-string">f"\nOutliers en {col}: {len(outliers)} filas"</span>)

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 8. RESUMEN FINAL</span>
<span class="code-comment"># ============================================</span>

<span class="code-function">print</span>(<span class="code-string">"\n=== RESUMEN DE LIMPIEZA ==="</span>)
<span class="code-function">print</span>(<span class="code-string">f"Dataset final: {df.shape}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Valores nulos restantes: {df.isnull().sum().sum()}"</span>)
<span class="code-function">print</span>(<span class="code-string">f"Duplicados restantes: {df.duplicated().sum()}"</span>)

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 9. GUARDAR DATOS LIMPIOS</span>
<span class="code-comment"># ============================================</span>

df.<span class="code-function">to_csv</span>(<span class="code-string">'datos_limpios.csv'</span>, index=<span class="code-keyword">False</span>)
<span class="code-function">print</span>(<span class="code-string">"\n‚úÖ Datos limpios guardados en 'datos_limpios.csv'"</span>)

<span class="code-comment"># ============================================</span>
<span class="code-comment"># 10. AN√ÅLISIS R√ÅPIDO</span>
<span class="code-comment"># ============================================</span>

<span class="code-function">print</span>(<span class="code-string">"\n=== AN√ÅLISIS B√ÅSICO ==="</span>)

<span class="code-comment"># Si hay columna de categor√≠a</span>
<span class="code-keyword">if</span> <span class="code-string">'categoria'</span> <span class="code-keyword">in</span> df.columns:
    <span class="code-function">print</span>(<span class="code-string">"\nDistribuci√≥n por categor√≠a:"</span>)
    <span class="code-function">print</span>(df[<span class="code-string">'categoria'</span>].<span class="code-function">value_counts</span>())

<span class="code-comment"># Si hay columna de ventas o precio</span>
<span class="code-keyword">if</span> <span class="code-string">'total'</span> <span class="code-keyword">in</span> df.columns:
    <span class="code-function">print</span>(<span class="code-string">f"\nVenta total: ${df['total'].sum():,.2f}"</span>)
    <span class="code-function">print</span>(<span class="code-string">f"Venta promedio: ${df['total'].mean():,.2f}"</span>)
            </div>
        </div>

        <!-- Conclusi√≥n -->
        <div class="section">
            <h2 class="section-title">üéØ Conclusi√≥n: ¬øCu√°ndo usar cada herramienta?</h2>
            
            <div class="comparison-container">
                <div class="method-card sheets-method">
                    <div class="method-header">
                        <div class="method-icon sheets-icon">üìä</div>
                        <div class="method-title">Usa Google Sheets cuando...</div>
                    </div>
                    <ul>
                        <li>‚úÖ Dataset peque√±o (< 10,000 filas)</li>
                        <li>‚úÖ Necesitas colaboraci√≥n en tiempo real</li>
                        <li>‚úÖ Exploraci√≥n visual r√°pida</li>
                        <li>‚úÖ Usuarios no t√©cnicos</li>
                        <li>‚úÖ Reportes simples</li>
                        <li>‚úÖ Gr√°ficos b√°sicos r√°pidos</li>
                    </ul>
                </div>

                <div class="method-card python-method">
                    <div class="method-header">
                        <div class="method-icon python-icon">üêç</div>
                        <div class="method-title">Usa Python cuando...</div>
                    </div>
                    <ul>
                        <li>‚úÖ Dataset grande (> 10,000 filas)</li>
                        <li>‚úÖ Necesitas automatizaci√≥n</li>
                        <li>‚úÖ Limpieza compleja de datos</li>
                        <li>‚úÖ An√°lisis reproducible</li>
                        <li>‚úÖ M√∫ltiples transformaciones</li>
                        <li>‚úÖ Integraci√≥n con ML/AI</li>
                        <li>‚úÖ Procesos repetitivos</li>
                    </ul>
                </div>
            </div>

            <div class="success-box" style="margin-top: 30px;">
                <h4>üí° Filosof√≠a de Trabajo Recomendada</h4>
                <p><strong>1. EXPLORAR</strong> en Google Sheets ‚Üí Entender visualmente los datos</p>
                <p><strong>2. LIMPIAR</strong> en Python ‚Üí Procesar eficientemente</p>
                <p><strong>3. ANALIZAR</strong> en Python ‚Üí Extraer insights complejos</p>
                <p><strong>4. COMPARTIR</strong> en el formato m√°s conveniente para tu audiencia</p>
            </div>
        </div>
    </div>

    <script>
        // Funci√≥n para tabs si decides agregar m√°s interactividad
        function showTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-button');
            
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Animaci√≥n de aparici√≥n al hacer scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Aplicar animaci√≥n a las secciones
        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(section);
        });
    </script>
</body>
</html>